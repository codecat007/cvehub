stagefright -s -a CVE-2017-0814.vorbis

```
=================================================================


==5663==ERROR: AddressSanitizer: heap-buffer-overflow on address 0xe8007500 at pc 0xe8121388 bp 0xe75feac8 sp 0xe75feac0


READ of size 4 at 0xe8007500 thread T2 (.vorbis.decoder)

    #100 0xe8121387 in vorbis_book_decodev_add /proc/self/cwd/external/tremolo/Tremolo/codebook.c:861

    #101 0xe813caa3 in res_inverse /proc/self/cwd/external/tremolo/Tremolo/res012.c:172

    #102 0xe81397db in mapping_inverse /proc/self/cwd/external/tremolo/Tremolo/mapping0.c:191

    #103 0xe81236eb in vorbis_dsp_synthesis /proc/self/cwd/external/tremolo/Tremolo/dsp.c:240

    #104 0xeada645f in _ZN7android10SoftVorbis13onQueueFilledEj /proc/self/cwd/frameworks/av/media/libstagefright/codecs/vorbis/dec/SoftVorbis.cpp:396 (discriminator 1)

    #105 0xead60d93 in _ZN7android22SimpleSoftOMXComponent17onMessageReceivedERKNS_2spINS_8AMessageEEE /proc/self/cwd/frameworks/av/media/libstagefright/omx/SimpleSoftOMXComponent.cpp:383

    #106 0xead65833 in _ZN7android17AHandlerReflectorINS_22SimpleSoftOMXComponentEE17onMessageReceivedERKNS_2spINS_8AMessageEEE /proc/self/cwd/frameworks/av/include/media/stagefright/foundation/AHandlerReflector.h:35 (discriminator 1)

    #107 0xe9fb9f73 in _ZN7android8AHandler14deliverMessageERKNS_2spINS_8AMessageEEE /proc/self/cwd/frameworks/av/media/libstagefright/foundation/AHandler.cpp:27

    #108 0xe9fc68a7 in _ZN7android8AMessage7deliverEv /proc/self/cwd/frameworks/av/media/libstagefright/foundation/AMessage.cpp:381 (discriminator 2)

    #109 0xe9fbd853 in _ZN7android7ALooper4loopEv /proc/self/cwd/frameworks/av/media/libstagefright/foundation/ALooper.cpp:220 (discriminator 1)

    #110 0xe9f8713f in _ZN7android6Thread11_threadLoopEPv /proc/self/cwd/system/core/libutils/Threads.cpp:754

    #111 0xe9e69093 in _ZL15__pthread_startPv /proc/self/cwd/bionic/libc/bionic/pthread_create.cpp:198 (discriminator 1)

    #112 0xe9e3bbdd in __start_thread /proc/self/cwd/bionic/libc/bionic/clone.cpp:41 (discriminator 1)



0xe8007500 is located 0 bytes to the right of 4096-byte region [0xe8006500,0xe8007500)

allocated by thread T2 (.vorbis.decoder) here:

    #113 0xea090df7 in calloc ??:?

    #114 0xe812233f in vorbis_dsp_init /proc/self/cwd/external/tremolo/Tremolo/dsp.c:76

    #115 0xeada71bb in _ZN7android10SoftVorbis13onQueueFilledEj /proc/self/cwd/frameworks/av/media/libstagefright/codecs/vorbis/dec/SoftVorbis.cpp:314 (discriminator 5)

    #116 0xead60d93 in _ZN7android22SimpleSoftOMXComponent17onMessageReceivedERKNS_2spINS_8AMessageEEE /proc/self/cwd/frameworks/av/media/libstagefright/omx/SimpleSoftOMXComponent.cpp:383

    #117 0xead65833 in _ZN7android17AHandlerReflectorINS_22SimpleSoftOMXComponentEE17onMessageReceivedERKNS_2spINS_8AMessageEEE /proc/self/cwd/frameworks/av/include/media/stagefright/foundation/AHandlerReflector.h:35 (discriminator 1)

    #118 0xe9fb9f73 in _ZN7android8AHandler14deliverMessageERKNS_2spINS_8AMessageEEE /proc/self/cwd/frameworks/av/media/libstagefright/foundation/AHandler.cpp:27

    #119 0xe9fc68a7 in _ZN7android8AMessage7deliverEv /proc/self/cwd/frameworks/av/media/libstagefright/foundation/AMessage.cpp:381 (discriminator 2)

    #120 0xe9fbd853 in _ZN7android7ALooper4loopEv /proc/self/cwd/frameworks/av/media/libstagefright/foundation/ALooper.cpp:220 (discriminator 1)

    #121 0xe9f8713f in _ZN7android6Thread11_threadLoopEPv /proc/self/cwd/system/core/libutils/Threads.cpp:754

    #122 0xe9e69093 in _ZL15__pthread_startPv /proc/self/cwd/bionic/libc/bionic/pthread_create.cpp:198 (discriminator 1)



Thread T2 (.vorbis.decoder) created by T1 (Binder:5663_1) here:

    #123 0xea0784db in pthread_create ??:?

    #124 0xe9f8587f in androidCreateRawThreadEtc /proc/self/cwd/system/core/libutils/Threads.cpp:160 (discriminator 1)

    #125 0xe9f8695b in _ZN7android6Thread3runEPKcij /proc/self/cwd/system/core/libutils/Threads.cpp:696

    #126 0xe9fbd1f3 in _ZN7android7ALooper5startEbbi /proc/self/cwd/frameworks/av/media/libstagefright/foundation/ALooper.cpp:123 (discriminator 1)

    #127 0xead5d663 in SimpleSoftOMXComponent /proc/self/cwd/frameworks/av/media/libstagefright/omx/SimpleSoftOMXComponent.cpp:42 (discriminator 1)

    #128 0xeada3f6b in SoftVorbis /proc/self/cwd/frameworks/av/media/libstagefright/codecs/vorbis/dec/SoftVorbis.cpp:50

    #129 0xeada811b in _Z22createSoftOMXComponentPKcPK16OMX_CALLBACKTYPEPvPP17OMX_COMPONENTTYPE /proc/self/cwd/frameworks/av/media/libstagefright/codecs/vorbis/dec/SoftVorbis.cpp:525 (discriminator 1)

    #130 0xead66cb3 in _ZN7android13SoftOMXPlugin21makeComponentInstanceEPKcPK16OMX_CALLBACKTYPEPvPP17OMX_COMPONENTTYPE /proc/self/cwd/frameworks/av/media/libstagefright/omx/SoftOMXPlugin.cpp:112

    #131 0xead4083f in _ZN7android9OMXMaster21makeComponentInstanceEPKcPK16OMX_CALLBACKTYPEPvPP17OMX_COMPONENTTYPE /proc/self/cwd/frameworks/av/media/libstagefright/omx/OMXMaster.cpp:163

    #132 0xead36337 in _ZN7android3OMX12allocateNodeEPKcRKNS_2spINS_12IOMXObserverEEEPNS3_INS_7IBinderEEEPj /proc/self/cwd/frameworks/av/media/libstagefright/omx/OMX.cpp:261 (discriminator 1)

    #133 0xea68a5fb in _ZN7android5BnOMX10onTransactEjRKNS_6ParcelEPS1_j /proc/self/cwd/frameworks/av/media/libmedia/IOMX.cpp:691 (discriminator 1)

    #134 0xeaa88913 in _ZN7android7BBinder8transactEjRKNS_6ParcelEPS1_j /proc/self/cwd/frameworks/native/libs/binder/Binder.cpp:126

    #135 0xeaaaabcf in _ZN7android14IPCThreadState14executeCommandEi /proc/self/cwd/frameworks/native/libs/binder/IPCThreadState.cpp:1077

    #136 0xeaaaa107 in _ZN7android14IPCThreadState20getAndExecuteCommandEv /proc/self/cwd/frameworks/native/libs/binder/IPCThreadState.cpp:446

    #137 0xeaaab55b in _ZN7android14IPCThreadState14joinThreadPoolEb /proc/self/cwd/frameworks/native/libs/binder/IPCThreadState.cpp:500

    #138 0xeab0f69f in _ZN7android10PoolThread10threadLoopEv /proc/self/cwd/frameworks/native/libs/binder/ProcessState.cpp:63 (discriminator 1)

    #139 0xe9f86f37 in _ZN7android6Thread11_threadLoopEPv /proc/self/cwd/system/core/libutils/Threads.cpp:751

    #140 0xe9e69093 in _ZL15__pthread_startPv /proc/self/cwd/bionic/libc/bionic/pthread_create.cpp:198 (discriminator 1)



Thread T1 (Binder:5663_1) created by T0 here:

    #141 0xea0784db in pthread_create ??:?

    #142 0xe9f8587f in androidCreateRawThreadEtc /proc/self/cwd/system/core/libutils/Threads.cpp:160 (discriminator 1)

    #143 0xe9f86933 in androidCreateThreadEtc /proc/self/cwd/system/core/libutils/Threads.cpp:296
    #144 0xe9f86933 in _ZN7android15createThreadEtcEPFiPvES0_PKcijPS0_ /proc/self/cwd/system/core/include/utils/AndroidThreads.h:111
    #145 0xe9f86933 in _ZN7android6Thread3runEPKcij /proc/self/cwd/system/core/libutils/Threads.cpp:693

    #146 0xeab0d167 in _ZN7android12ProcessState17spawnPooledThreadEb /proc/self/cwd/frameworks/native/libs/binder/ProcessState.cpp:293 (discriminator 2)

    #147 0xeab0cef7 in _ZN7android12ProcessState15startThreadPoolEv /proc/self/cwd/frameworks/native/libs/binder/ProcessState.cpp:137

    #148 0xb491914b in main /proc/self/cwd/frameworks/av/services/mediacodec/main_codecservice.cpp:45 (discriminator 2)

    #149 0xe9e38c61 in __libc_init /proc/self/cwd/bionic/libc/bionic/libc_init_dynamic.cpp:109

    #7 0xffffffff  (<unknown module>)



SUMMARY: AddressSanitizer: heap-buffer-overflow (/data/lib/libvorbisidec.so+0x8387)

Shadow bytes around the buggy address:
  0x1d000e50: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
  0x1d000e60: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
  0x1d000e70: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
  0x1d000e80: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
  0x1d000e90: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
=>0x1d000ea0:[fa]fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x1d000eb0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x1d000ec0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x1d000ed0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x1d000ee0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x1d000ef0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
Shadow byte legend (one shadow byte represents 8 application bytes):
  Addressable:           00
  Partially addressable: 01 02 03 04 05 06 07
  Heap left redzone:       fa
  Heap right redzone:      fb
  Freed heap region:       fd
  Stack left redzone:      f1
  Stack mid redzone:       f2
  Stack right redzone:     f3
  Stack partial redzone:   f4
  Stack after return:      f5
  Stack use after scope:   f8
  Global redzone:          f9
  Global init order:       f6
  Poisoned by user:        f7
  Container overflow:      fc
  Array cookie:            ac
  Intra object redzone:    bb
  ASan internal:           fe
  Left alloca redzone:     ca
  Right alloca redzone:    cb

==5663==ABORTING
```